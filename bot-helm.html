<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DigiAgro</title>
  <meta name="color-scheme" content="light dark" />

  <!-- CSS del widget n8n (mover al head) -->
  <link href="https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css" rel="stylesheet" />

  <style>
    :root{
      --verde:#2a5c2a; --marron:#6b4f2c; --bgCard:rgba(255,255,255,.88);
      --shadow:0 4px 10px rgba(0,0,0,.12); --radius:14px; --safe: env(safe-area-inset-bottom);
    }

    /* ===== SCOPE ===== */
    .dg *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    .dg{
      margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; line-height:1.45;
      background-image:url('fondo.png'); background-size:cover; background-position:center; background-repeat:no-repeat;
      background-attachment:fixed; padding-bottom:max(72px,var(--safe));
    }

    /* Header */
    .dg header{
      position:relative; min-height:48vh; max-height:520px;
      display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;
      overflow:hidden; isolation:isolate;
    }
    .dg header video{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; z-index:-1}
    .dg header h1{
      color:#fff; margin:24px 12px 0; font-size:clamp(28px,5vw,56px); font-weight:800;
      text-shadow:0 2px 14px rgba(0,0,0,.45); animation:fadeInHeader .8s ease-out both;
    }
    @keyframes fadeInHeader{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
    .dg .marquesina{
      position:absolute; bottom:16px; left:50%; transform:translateX(-50%);
      background:rgba(0,0,0,.5); color:#fff; padding:8px 14px; border-radius:999px; backdrop-filter:blur(4px);
      max-width:92%;
    }
    .dg .marquesina p{margin:0; font-weight:700; font-size:clamp(14px,3.2vw,20px)}

    /* Logo fijo */
    .dg .logo-sticky{
      position:fixed; bottom:14px; left:14px; height:64px; opacity:.7; z-index:900;
      transition:transform .2s ease, opacity .2s ease;
    }
    .dg .logo-sticky:hover{opacity:1; transform:scale(1.06)}

    /* ===== NAV responsive (fix iOS) ===== */
    .dg nav{
      background:var(--marron);
      position:sticky; top:0;
      z-index:1200;
      box-shadow:0 2px 8px rgba(0,0,0,.15);
    }
    .dg nav .nav-inner{
      max-width:1100px; margin:0 auto;
      display:flex; align-items:center; justify-content:center;
      gap:18px; padding:8px 12px;
      position:relative;
    }
    .dg nav .links{
      display:flex; gap:18px; flex-wrap:wrap; list-style:none; margin:0; padding:0;
      font-weight:800; letter-spacing:.2px;
    }
    .dg nav .links a{
      display:inline-block; color:#fff; text-decoration:none; font-weight:700;
      padding:12px 10px; border-radius:10px;
    }
    .dg nav .links a:hover{ text-decoration:underline }
    .dg nav .hamburger{
      display:none; cursor:pointer; border:0; background:transparent; color:#fff;
      padding:12px; position:absolute; right:8px; top:2px; z-index:1203;
      -webkit-tap-highlight-color: transparent;
    }
    .dg nav .hamburger svg{width:26px; height:26px}
    .dg .links.mobile{
      display:none; flex-direction:column; gap:6px;
      position:absolute; left:0; right:0; top:100%;
      background:var(--marron);
      border-top:1px solid rgba(255,255,255,.15);
      box-shadow:0 10px 18px rgba(0,0,0,.25);
      z-index:1202; padding:10px 16px 14px;
    }
    .dg .links.mobile[hidden]{display:none !important}
    .dg .links.mobile a{display:block; padding:12px 0; border-radius:8px}
    .dg section{display:flex; justify-content:center; align-items:center; flex-direction:column; padding:36px 16px}
    .dg .seccion{
      width:min(760px,92%); background:var(--bgCard); border-radius:var(--radius); box-shadow:var(--shadow);
      padding:clamp(16px,3.6vw,24px); animation:fadeInContent .7s ease both;
    }
    @keyframes fadeInContent{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .dg .seccion h2{color:var(--verde); font-size:clamp(20px,3.6vw,28px); margin-top:0}
    .dg .seccion p{margin:.4rem 0; font-size:clamp(14px,2.8vw,16px)}

    /* Si el chat tapa la nav, bajale su z-index aqu√≠ */
    .dg #chat-widget-root, .dg .chat-widget-container, .dg .n8n-chat-container{
      /* z-index:950 !important; */
    }

    @media (max-width:900px){
      .dg nav .links{display:none}
      .dg nav .hamburger{display:inline-flex}
      .dg .links.mobile{display:flex}
      .dg nav .nav-inner{justify-content:space-between}
    }
    @media (max-width:600px){
      .dg header{min-height:44vh}
      .dg .logo-sticky{height:50px; bottom:12px; left:12px}
      .dg .marquesina{bottom:12px}
      .dg{background-attachment:scroll}
    }
    @media (prefers-reduced-motion: reduce){
      .dg *{animation:none !important; transition:none !important; scroll-behavior:auto !important}
    }
  </style>
</head>
<body>
  <div class="dg">
    <img src="DigiAgro.png" alt="Logo DigiAgro" class="logo-sticky">
    <!-- ...tu contenido... -->
  </div>

  <!-- Script del widget n8n (opci√≥n B: se abre solo) -->
  <script type="module">
    import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js';

    // Inicializar en modo ventana (sin target)
    const chat = createChat({
      webhookUrl: 'https://jjg.app.n8n.cloud/webhook/8c90edd6-52a3-4069-8afd-d97a9fd86e31/chat',
      webhookConfig: { method: 'POST', headers: {} },
      mode: 'window',
      showWelcomeScreen: false,
      defaultLanguage: 'es',
      loadPreviousSession: true,
      chatInputKey: 'chatInput',
      chatSessionKey: 'sessionId',
      initialMessages: ['¬°Hola! üëã','¬øEn qu√© te puedo ayudar hoy?'],
      i18n: {
        es: {
          title: 'Soy DIGIBOT ü§ñ',
          subtitle: 'Estoy 24/7 para ayudarte',
          footer: '',
          getStarted: 'Nueva conversaci√≥n',
          inputPlaceholder: 'Escrib√≠ tu consulta',
        },
      },
      enableStreaming: false,
    });

    // Exponer y abrir autom√°ticamente
    window.n8nChat = chat;
    window.addEventListener('load', () => {
      setTimeout(() => window.n8nChat?.open?.(), 50);
    });

    // (Opcional) Toggle men√∫ m√≥vil si lo ten√©s en el DOM
    const btn = document.querySelector('.dg .hamburger');
    const mobileMenu = document.getElementById('mobileMenu');
    btn?.addEventListener('click', () => {
      const isOpen = !mobileMenu.hasAttribute('hidden');
      if (isOpen) {
        mobileMenu.setAttribute('hidden','');
        btn.setAttribute('aria-expanded','false');
      } else {
        mobileMenu.removeAttribute('hidden');
        btn.setAttribute('aria-expanded','true');
      }
    });
  </script>
</body>
</html>
